{"remainingRequest":"D:\\DELL\\Desktop\\Resource\\Webstudy\\13-vue3\\二次学习\\vue08\\打包上线版本\\v1.1\\client\\node_modules\\vue-loader-v16\\dist\\index.js??ref--1-1!D:\\DELL\\Desktop\\Resource\\Webstudy\\13-vue3\\二次学习\\vue08\\打包上线版本\\v1.1\\client\\src\\components\\Admin\\ArticleAdd.vue?vue&type=style&index=0&id=6f29155b&lang=less&scoped=true","dependencies":[{"path":"D:\\DELL\\Desktop\\Resource\\Webstudy\\13-vue3\\二次学习\\vue08\\打包上线版本\\v1.1\\client\\src\\components\\Admin\\ArticleAdd.vue","mtime":1657520581989},{"path":"D:\\DELL\\Desktop\\Resource\\Webstudy\\13-vue3\\二次学习\\vue08\\打包上线版本\\v1.1\\client\\node_modules\\css-loader\\dist\\cjs.js","mtime":1653658406923},{"path":"D:\\DELL\\Desktop\\Resource\\Webstudy\\13-vue3\\二次学习\\vue08\\打包上线版本\\v1.1\\client\\node_modules\\vue-loader-v16\\dist\\stylePostLoader.js","mtime":1653658409503},{"path":"D:\\DELL\\Desktop\\Resource\\Webstudy\\13-vue3\\二次学习\\vue08\\打包上线版本\\v1.1\\client\\node_modules\\postcss-loader\\src\\index.js","mtime":1653658408121},{"path":"D:\\DELL\\Desktop\\Resource\\Webstudy\\13-vue3\\二次学习\\vue08\\打包上线版本\\v1.1\\client\\node_modules\\less-loader\\dist\\cjs.js","mtime":1653658407684},{"path":"D:\\DELL\\Desktop\\Resource\\Webstudy\\13-vue3\\二次学习\\vue08\\打包上线版本\\v1.1\\client\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1653658406323},{"path":"D:\\DELL\\Desktop\\Resource\\Webstudy\\13-vue3\\二次学习\\vue08\\打包上线版本\\v1.1\\client\\node_modules\\vue-loader-v16\\dist\\index.js","mtime":1653658408462}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CiNBcnRpY2xlQWRkIHsKICAvZGVlcC8uZWwtdXBsb2FkIHsKICAgIGJvcmRlcjogMXB4IGRhc2hlZCAjZDlkOWQ5OwogICAgYm9yZGVyLXJhZGl1czogNnB4OwogICAgY3Vyc29yOiBwb2ludGVyOwogICAgcG9zaXRpb246IHJlbGF0aXZlOwogICAgb3ZlcmZsb3c6IGhpZGRlbjsKICAgIG1hcmdpbi10b3A6IDEwcHg7CiAgICAuYXZhdGFyLXVwbG9hZGVyLWljb24gewogICAgICBmb250LXNpemU6IDI4cHg7CiAgICAgIGNvbG9yOiAjOGM5MzlkOwogICAgICB3aWR0aDogMTc4cHg7CiAgICAgIGhlaWdodDogMTc4cHg7CiAgICAgIGxpbmUtaGVpZ2h0OiAxNzhweDsKICAgICAgdGV4dC1hbGlnbjogY2VudGVyOwogICAgfQogIH0KICBkaXYuYXZhdGFyIHsKICAgIGRpc3BsYXk6IGJsb2NrOwogICAgd2lkdGg6IDE3OHB4OwogICAgaGVpZ2h0OiAxNzhweDsKICAgIG1heC13aWR0aDogMTc4cHg7CiAgICBtYXgtaGVpZ2h0OiAxNzhweDsKICAgIGJhY2tncm91bmQ6IG5vbmUgY2VudGVyIGNlbnRlci9jb3ZlcjsKICB9Cn0K"},{"version":3,"sources":["D:\\DELL\\Desktop\\Resource\\Webstudy\\13-vue3\\二次学习\\vue08\\打包上线版本\\v1.1\\client\\src\\components\\Admin\\ArticleAdd.vue"],"names":[],"mappings":";AAyKA,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;EACV,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;IACf,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IAC1B,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;IAClB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IACf,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IAClB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IAChB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;IAChB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;MACpB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;MACf,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;MACd,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;MACZ,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;MACb,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;MAClB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IACpB;EACF;EACA,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;IACT,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;IACd,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;IACZ,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;IACb,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;IAChB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;IACjB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;EACtC;AACF","file":"D:/DELL/Desktop/Resource/Webstudy/13-vue3/二次学习/vue08/打包上线版本/v1.1/client/src/components/Admin/ArticleAdd.vue","sourceRoot":"","sourcesContent":["\n<template>\n  <div id=\"ArticleAdd\">\n    <el-form ref=\"form\" :model=\"form\" status-icon label-width=\"120px\">\n      <el-form-item label=\"标题：\">\n        <el-input\n          v-model=\"form.title\"\n          placeholder=\"可通过上传md自动获取文件名\"\n        ></el-input>\n      </el-form-item>\n      <el-form-item label=\"描述：\">\n        <el-input v-model=\"form.des\" type=\"textarea\"></el-input>\n      </el-form-item>\n      <el-form-item label=\"md上传：\">\n        <el-upload\n          class=\"upload-demo\"\n          :with-credentials=\"true\"\n          :limit=\"1\"\n          drag\n          :on-change=\"fileChange\"\n          :on-success=\"md_upload_success\"\n          :before-remove=\"beforeRemove\"\n          :action=\"`${baseURL}/adminServer/article/md`\"\n          :auto-upload=\"false\"\n          ref=\"mdForm\"\n        >\n          <el-icon class=\"el-icon--upload\"><upload-filled /></el-icon>\n          <div class=\"el-upload_text\">将文件拖到此处，或<em>点击上传</em></div>\n          <template #tip>\n            <div class=\"el-upload_tip\">只能上传 .md 文件</div>\n          </template>\n        </el-upload>\n      </el-form-item>\n      <el-form-item label=\"封面上传：\">\n        <el-upload\n          class=\"avatar-uploader\"\n          :with-credentials=\"true\"\n          :action=\"`${baseURL}/adminServer/article/cover`\"\n          :show-file-list=\"false\"\n          :auto-upload=\"false\"\n          :on-success=\"cover_upload_success\"\n          :on-change=\"coverChange\"\n          ref=\"imgForm\"\n        >\n          <div\n            v-if=\"imageUrl\"\n            class=\"avatar\"\n            :style=\"{ backgroundImage: `url(${imageUrl})` }\"\n          />\n          <i v-else class=\"el-icon-plus avatar-uploader-icon\"></i>\n        </el-upload>\n      </el-form-item>\n      <el-form-item>\n        <el-button type=\"primary\" @click=\"submitForm('ruleForm')\"\n          >确认发表</el-button\n        >\n      </el-form-item>\n    </el-form>\n  </div>\n</template>\n\n<script>\nexport default {\n  data() {\n    return {\n      form: {\n        title: \"\",\n        des: \"\",\n        md: \"\",\n        cover: \"\",\n      },\n      imageUrl: \"\",\n    };\n  },\n  methods: {\n    submitForm() {\n     this.$refs.mdForm.submit()\n    },\n    //文章的发表\n    async submit(){\n      let {data} = await this.$axios({\n        method:\"POST\",\n        url:\"/adminServer/article/add\",\n        data:this.form\n      })\n      console.log(data);\n      if(data.code){\n        return this.$message.error(data.msg)\n      }\n      //跳转到对应的文章\n      this.$router.push(`/article/${data.data.id}`)\n      this.$message.success(\"发表成功\")\n    },\n    //添加md文件的钩子\n    fileChange(file, fileList) {\n      console.log(file);\n      if (file.status !== \"ready\") return;\n      //简单判断是否是.md文件\n      let reg = /^(.+)\\.md$/;\n      if (reg.test(file.name)) {\n        //当没有输入title的时候 获取名字填充到title\n        //console.log(this.form.name);、\n\n        //通过原子组进行匹配 两者是一致的结果\n        //console.log(file.name.match(reg)[1]);\n        //console.log(RegExp.$1);\n        if (this.form.title) return;\n        this.form.title = RegExp.$1;\n      } else {\n        //提示并阻止文件添加\n        this.$message.error(\"只能上传.md文件\");\n        fileList.pop();\n      }\n    },\n    //删除md文件之前文件的钩子\n    beforeRemove() {\n      this.form.title = \"\";\n    },\n    //md上传成功的钩子函数\n    md_upload_success(res){ \n      //上传md失败\n      if(res.code){   \n        return this.$message.error(\"上传md失败，请检查后端报错\")\n      }\n      //md上传成功\n      this.form.md = res.url\n      //判断是否又封面图\n      if(this.imageUrl){\n        //有封面图就触发封面图的上传\n        this.$refs.imgForm.submit()\n      }else{\n        //没有封面图 直接发表文章\n        this.submit()\n      }\n      console.log(res);\n    },\n    //添加封面的钩子\n    coverChange(file, fileList) {\n      if (file.status !== \"ready\") return;\n      const isJPG = /^image\\/(jpeg|png)$/.test(file.raw.type);\n      const isLt2M = file.raw.size / 1024 / 1024 < 2;\n\n      if (!isJPG) {\n        this.$message.error(\"上传头像图片只能为JPG|PNG格式!\");\n      }\n      if (!isLt2M) {\n        this.$message.error(\"上传头像图片大小不能超过 2MB!\");\n      }\n      if(isJPG && isLt2M){\n        this.imageUrl = URL.createObjectURL(file.raw);\n      }else{\n        this.imageUrl = \" \"\n        fileList.pop()\n      }\n    },\n    //封面上传成功\n    cover_upload_success(res){\n      console.log(res);\n      if(res.code){\n        return this.$message.error(\"上传封面失败，请检查后端后重试\")\n      }\n      this.form.cover = res.url\n      this.submit()\n    }\n  },\n};\n</script>\n\n<style lang='less' scoped>\n#ArticleAdd {\n  /deep/.el-upload {\n    border: 1px dashed #d9d9d9;\n    border-radius: 6px;\n    cursor: pointer;\n    position: relative;\n    overflow: hidden;\n    margin-top: 10px;\n    .avatar-uploader-icon {\n      font-size: 28px;\n      color: #8c939d;\n      width: 178px;\n      height: 178px;\n      line-height: 178px;\n      text-align: center;\n    }\n  }\n  div.avatar {\n    display: block;\n    width: 178px;\n    height: 178px;\n    max-width: 178px;\n    max-height: 178px;\n    background: none center center/cover;\n  }\n}\n</style>"]}]}